{% extends "base.html" %}
{% block body %}
<div class="max-w-6xl mx-auto py-6 text-gray-100">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-semibold">Compras</h1>
    <div class="flex gap-2">
      <a href="{{ url_for('financeiro_dashboard') }}" class="px-3 py-2 rounded-xl bg-black/40 border border-zinc-800 text-sm hover:bg-black/55">Financeiro</a>
      <a href="{{ url_for('compras_nova') }}" class="px-3 py-2 rounded-xl bg-red-500 hover:bg-red-600 text-sm font-semibold">+ Nova compra</a>
    </div>
  </div>

  <div class="rounded-2xl bg-black/40 border border-zinc-800 p-4">
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead>
          <tr class="text-left text-zinc-400">
            <th class="py-2">Data</th>
            <th>Fornecedor</th>
            <th>Doc</th>
            <th>Pagamento</th>
            <th class="text-right">Total</th>
            <th>Status</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
          <tr class="border-t border-zinc-800">
            <td class="py-2">{{ r.date }}</td>
            <td class="text-zinc-200 font-semibold">{{ r.supplier }}</td>
            <td class="text-zinc-400">{{ r.doc_number or '-' }}</td>
            <td class="text-zinc-400">{{ r.pm_name or '-' }}</td>
            <td class="text-right font-semibold">{{ r.total|money }}</td>
            <td class="text-xs">{{ r.status }}</td>
            <td class="text-right">
              <a href="{{ url_for('compras_editar', purchase_id=r.id) }}" class="px-2 py-1 rounded-lg bg-black/30 border border-zinc-700 hover:bg-black/50 text-xs">Editar</a>
            </td>
          </tr>
          {% endfor %}
          {% if not rows %}
          <tr><td colspan="7" class="py-3 text-zinc-400">Nenhuma compra cadastrada.</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
    <div class="text-xs text-zinc-500 mt-3">
      Dica: o estoque só é ajustado quando a compra estiver com status <b>EFETIVADO</b>.
    </div>
  </div>
</div>
{% endblock %}
